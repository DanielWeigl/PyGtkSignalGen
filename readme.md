Based on http://arachnoid.com/python/signalgen_program.html
